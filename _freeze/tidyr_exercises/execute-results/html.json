{
  "hash": "dccf3f2b0d10b5d8622ecc4ae4f15a5f",
  "result": {
    "markdown": "---\ntitle: \"tidyr exercises\"\nformat: html\neditor: visual\n---\n\n\n## Setup\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nlibrary(admiral)\nlibrary(admiral.test)\nlibrary(dplyr)\nlibrary(tidyr)\n\n# load data\nex <- admiral_ex\ndm <- admiral_dm\nds <- admiral_ds\nsuppds <- admiral_suppds\n```\n:::\n\n\n## Pivoting with tidyr\n\nLoad the `ex` data-frame from `admiral_ex`and select the following variables:\n\n-   USUBJID\n\n-   EXTRT\n\n-   VISIT\n\n-   EXSTDTC\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\" code-summary=\"Show solution\"}\nex %>% \n  select(USUBJID, EXTRT, VISIT, EXSTDTC)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 591 × 4\n   USUBJID     EXTRT      VISIT    EXSTDTC   \n   <chr>       <chr>      <chr>    <chr>     \n 1 01-701-1015 PLACEBO    BASELINE 2014-01-02\n 2 01-701-1015 PLACEBO    WEEK 2   2014-01-17\n 3 01-701-1015 PLACEBO    WEEK 24  2014-06-19\n 4 01-701-1023 PLACEBO    BASELINE 2012-08-05\n 5 01-701-1023 PLACEBO    WEEK 2   2012-08-28\n 6 01-701-1028 XANOMELINE BASELINE 2013-07-19\n 7 01-701-1028 XANOMELINE WEEK 2   2013-08-02\n 8 01-701-1028 XANOMELINE WEEK 24  2014-01-07\n 9 01-701-1033 XANOMELINE BASELINE 2014-03-18\n10 01-701-1034 XANOMELINE BASELINE 2014-07-01\n# … with 581 more rows\n```\n:::\n:::\n\n\nUsing `pivot_wider()` create a table that would shaped this way\n\n| USUBJID | EXTRT | BASELINE | WEEK 2 | WEEK 24 |\n|---------|-------|----------|--------|---------|\n| ...     | ...   | ...      | ...    | ...     |\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\" code-summary=\"Show solution\"}\nex %>% \n  select(USUBJID, EXTRT, VISIT, EXSTDTC) %>% \n  pivot_wider(names_from = \"VISIT\", values_from = \"EXSTDTC\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 254 × 5\n   USUBJID     EXTRT      BASELINE   `WEEK 2`   `WEEK 24` \n   <chr>       <chr>      <chr>      <chr>      <chr>     \n 1 01-701-1015 PLACEBO    2014-01-02 2014-01-17 2014-06-19\n 2 01-701-1023 PLACEBO    2012-08-05 2012-08-28 <NA>      \n 3 01-701-1028 XANOMELINE 2013-07-19 2013-08-02 2014-01-07\n 4 01-701-1033 XANOMELINE 2014-03-18 <NA>       <NA>      \n 5 01-701-1034 XANOMELINE 2014-07-01 2014-07-16 2014-12-18\n 6 01-701-1047 PLACEBO    2013-02-12 2013-02-26 <NA>      \n 7 01-701-1097 XANOMELINE 2014-01-01 2014-01-16 2014-06-19\n 8 01-701-1111 XANOMELINE 2012-09-07 <NA>       <NA>      \n 9 01-701-1115 XANOMELINE 2012-11-30 2012-12-14 <NA>      \n10 01-701-1118 PLACEBO    2014-03-12 2014-03-27 2014-08-28\n# … with 244 more rows\n```\n:::\n:::\n\n\nLoad the `dm` data-frame from `admiral_dm`and select the following variables:\n\n-   USUBJID\n\n-   RACE\n\n-   SEX\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\" code-summary=\"Show solution\"}\ndm %>% \n  select(USUBJID, RACE, SEX)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 306 × 3\n   USUBJID     RACE  SEX  \n   <chr>       <chr> <chr>\n 1 01-701-1015 WHITE F    \n 2 01-701-1023 WHITE M    \n 3 01-701-1028 WHITE M    \n 4 01-701-1033 WHITE M    \n 5 01-701-1034 WHITE F    \n 6 01-701-1047 WHITE F    \n 7 01-701-1057 WHITE F    \n 8 01-701-1097 WHITE M    \n 9 01-701-1111 WHITE F    \n10 01-701-1115 WHITE M    \n# … with 296 more rows\n```\n:::\n:::\n\n\nUsing `pivot_longer()` create a table that would shaped this way\n\n| USUBJID | VAR  | VAL   |\n|---------|------|-------|\n| 1001    | RACE | WHITE |\n| 1001    | SEX  | M     |\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\" code-summary=\"Show solution\"}\ndm %>% \n  select(USUBJID, RACE, SEX) %>% \n  pivot_longer(cols = c(RACE, SEX),\n               names_to = \"VAR\",\n               values_to = \"VAL\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 612 × 3\n   USUBJID     VAR   VAL  \n   <chr>       <chr> <chr>\n 1 01-701-1015 RACE  WHITE\n 2 01-701-1015 SEX   F    \n 3 01-701-1023 RACE  WHITE\n 4 01-701-1023 SEX   M    \n 5 01-701-1028 RACE  WHITE\n 6 01-701-1028 SEX   M    \n 7 01-701-1033 RACE  WHITE\n 8 01-701-1033 SEX   M    \n 9 01-701-1034 RACE  WHITE\n10 01-701-1034 SEX   F    \n# … with 602 more rows\n```\n:::\n:::\n\n\n## Joining using dplyr\n\nLoad the `ds` data-frame from `admiral_ds` and `suppds` data-frame from `admiral_suppds`. Prior to joining the two datasets together, we may need to do some cleaning of the data on `suppds`.\n\n-   Filter IDVAR for \"DSSEQ\"\n\n-   Mutate IDVARVAL from type character to type numeric.\n\n-   Select USUBJID IDVARVAL QNAM QLABEL QVAL\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\" code-summary=\"Show solution\"}\nsuppds <- suppds %>% \n  filter(IDVAR == \"DSSEQ\") %>% \n  mutate(IDVARVAL = as.numeric(IDVARVAL)) %>% \n  select(USUBJID, IDVARVAL, QNAM, QLABEL, QVAL)\n\nsuppds\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 3 × 5\n  USUBJID     IDVARVAL QNAM    QLABEL                          QVAL \n  <chr>          <dbl> <chr>   <chr>                           <chr>\n1 01-703-1175        2 ENTCRIT PROTOCOL ENTRY CRITERIA NOT MET 16   \n2 01-705-1382        2 ENTCRIT PROTOCOL ENTRY CRITERIA NOT MET 25   \n3 01-708-1372        3 ENTCRIT PROTOCOL ENTRY CRITERIA NOT MET 16   \n```\n:::\n:::\n\n\nJoin the two tables together using `USUBJID` and `DSSEQ` as the key joining variables.\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\" code-summary=\"Show solution\"}\nds %>% \n  left_join(suppds, by = c(\"USUBJID\" = \"USUBJID\", \"DSSEQ\" = \"IDVARVAL\"))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 850 × 16\n   STUDYID  DOMAIN USUBJID DSSEQ DSSPID DSTERM DSDECOD DSCAT VISIT…¹ VISIT DSDTC\n   <chr>    <chr>  <chr>   <dbl> <chr>  <chr>  <chr>   <chr>   <dbl> <chr> <chr>\n 1 CDISCPI… DS     01-701…     1 <NA>   RANDO… RANDOM… PROT…       3 BASE… 2014…\n 2 CDISCPI… DS     01-701…     2 <NA>   PROTO… COMPLE… DISP…      13 WEEK… 2014…\n 3 CDISCPI… DS     01-701…     3 <NA>   FINAL… FINAL … OTHE…      13 WEEK… 2014…\n 4 CDISCPI… DS     01-701…     1 <NA>   RANDO… RANDOM… PROT…       3 BASE… 2012…\n 5 CDISCPI… DS     01-701…     2 24     ADVER… ADVERS… DISP…       5 WEEK… 2012…\n 6 CDISCPI… DS     01-701…     3 <NA>   FINAL… FINAL … OTHE…       5 WEEK… 2012…\n 7 CDISCPI… DS     01-701…     4 <NA>   FINAL… FINAL … OTHE…     201 RETR… 2013…\n 8 CDISCPI… DS     01-701…     1 <NA>   RANDO… RANDOM… PROT…       3 BASE… 2013…\n 9 CDISCPI… DS     01-701…     2 <NA>   PROTO… COMPLE… DISP…      13 WEEK… 2014…\n10 CDISCPI… DS     01-701…     3 <NA>   FINAL… FINAL … OTHE…      13 WEEK… 2014…\n# … with 840 more rows, 5 more variables: DSSTDTC <chr>, DSSTDY <dbl>,\n#   QNAM <chr>, QLABEL <chr>, QVAL <chr>, and abbreviated variable name\n#   ¹​VISITNUM\n```\n:::\n:::\n",
    "supporting": [
      "tidyr_exercises_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}