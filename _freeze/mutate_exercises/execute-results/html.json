{
  "hash": "a44d0409a213eb6f8f8403278cf30b9f",
  "result": {
    "markdown": "---\ntitle: \"`mutate()` Exercises\"\nauthor: \"Thomas\"\nformat: html\neditor: visual\n---\n\n\n## Setup\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(dplyr)\nlibrary(lubridate)\ndm <- readRDS(\"data/dm.rds\")\nae <- readRDS(\"data/ae.rds\")\n```\n:::\n\n\n## Exercise 1\n\nA treatment emergent adverse event is defined as an adverse event whose start date is on or after the treatment start date (`TRTSDT`) and at the latest starts 7 days after the treatment end date (`TRTEDT`). Given this definition calculate `TRTEMFL`.\n\n*Hint*: Turn the `--DTC` variables into proper dates first using the `ymd()` function.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nae %>% \n  mutate(\n    ASTDT = ymd(AESTDTC),\n    AENDT = ymd(AEENDTC),\n    TRTEMFL = if_else(ASTDT >= TRTSDT & ASTDT <= TRTEDT + 7, \"Y\", NA_character_)\n  ) %>% \n  select(USUBJID, ASTDT, AENDT, TRTSDT, TRTEDT, TRTEMFL)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: 19 failed to parse.\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 1,191 × 6\n   USUBJID     ASTDT      AENDT      TRTSDT     TRTEDT     TRTEMFL\n   <chr>       <date>     <date>     <date>     <date>     <chr>  \n 1 01-701-1015 2014-01-03 NA         2014-01-02 2014-07-02 Y      \n 2 01-701-1015 2014-01-03 NA         2014-01-02 2014-07-02 Y      \n 3 01-701-1015 2014-01-09 2014-01-11 2014-01-02 2014-07-02 Y      \n 4 01-701-1023 2012-08-26 NA         2012-08-05 2012-09-01 Y      \n 5 01-701-1023 2012-08-07 2012-08-30 2012-08-05 2012-09-01 Y      \n 6 01-701-1023 2012-08-07 NA         2012-08-05 2012-09-01 Y      \n 7 01-701-1023 2012-08-07 2012-08-30 2012-08-05 2012-09-01 Y      \n 8 01-701-1028 2013-07-21 NA         2013-07-19 2014-01-14 Y      \n 9 01-701-1028 2013-08-08 NA         2013-07-19 2014-01-14 Y      \n10 01-701-1034 2014-08-27 NA         2014-07-01 2014-12-30 Y      \n# … with 1,181 more rows\n```\n:::\n:::\n\n\n## Exercise 2\n\nCreate a new variable `REGION1` based upon `COUTRY` as shown in the table below.\n\n| Countries                           | Region        |\n|-------------------------------------|---------------|\n| Mexico, USA, Canada                 | North America |\n| Spain, Greece, Germany, Switzerland | Europe        |\n| China, Japan                        | Asia          |\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\" code-summary=\"Show solution\"}\ndm %>% \n  mutate(\n    REGION1 = case_when(\n      COUNTRY %in% c(\"Mexico\", \"USA\", \"Canada\") ~ \"North America\",\n      COUNTRY %in% c(\"Spain\", \"Greece\", \"Germany\", \"Switzerland\") ~ \"Europe\",\n      COUNTRY %in% c(\"China\", \"Japan\") ~ \"Asia\"\n    )\n  ) %>% \n  select(USUBJID, COUNTRY, REGION1)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 306 × 3\n   USUBJID     COUNTRY REGION1      \n   <chr>       <chr>   <chr>        \n 1 01-701-1015 USA     North America\n 2 01-701-1023 USA     North America\n 3 01-701-1028 USA     North America\n 4 01-701-1033 USA     North America\n 5 01-701-1034 USA     North America\n 6 01-701-1047 USA     North America\n 7 01-701-1057 USA     North America\n 8 01-701-1097 USA     North America\n 9 01-701-1111 USA     North America\n10 01-701-1115 USA     North America\n# … with 296 more rows\n```\n:::\n:::\n",
    "supporting": [
      "mutate_exercises_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}